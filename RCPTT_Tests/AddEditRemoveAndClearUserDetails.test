--- RCPTT testcase ---
Format-Version: 1.0
Element-Name: AddEditRemoveAndClearUserDetails
Element-Type: testcase
Element-Version: 3.0
External-Reference: 
Id: _G9wcgEUCEea3c7YIX-7B3A
Runtime-Version: 2.0.1.201508250612
Save-Time: 8/5/16 11:54 AM
Testcase-Type: ecl

------=_.content-0a7243a0-75d3-3d5f-9791-539de0e5b7ac
Content-Type: text/ecl
Entry-Name: .content

switch_to_experiment_details_view

/*
*	Clear and assert dashboard empty
*/
get-view "My View" | get-button Clear | click
get-view Dashboard | get-label "" -after [get-label "Users:"] | get-property "getText()" | equals "" | verify-true

/*
*	Add three default users and assert dashboard
*/
with [get-view "My View"] {
    with [get-button Add] {
        click
        click
        click
        click
    }
}
get-view Dashboard | get-label "DEFAULT_USER, DEFAULT_USER_1, DEFAULT_USER_2 and DEFAULT_USER_3" | get-property "getText()" 
    | equals "DEFAULT_USER, DEFAULT_USER_1, DEFAULT_USER_2 and DEFAULT_USER_3" | verify-true

/*
*	Remove single user and assert dashboard
*/
with [get-view "My View"] {
    with [get-table] {
        select "DEFAULT_USER_1" | activate-cell-edit
    }
    get-button Remove | click
}
get-view Dashboard | get-label "DEFAULT_USER, DEFAULT_USER_2 and DEFAULT_USER_3" | get-property "getText()" 
    | equals "DEFAULT_USER, DEFAULT_USER_2 and DEFAULT_USER_3" | verify-true
    
/*
*	Remove multiple user and assert dashboard
*/
with [get-view "My View"] {
    with [get-table] {
        select "DEFAULT_USER_2" "DEFAULT_USER_3"
    }
    get-button Remove | click
}
get-view Dashboard | get-label "DEFAULT_USER" | get-property "getText()" 
    | equals "DEFAULT_USER" | verify-true

/*
*	Edit user, set and assert dashboard
*/
get-view "My View" | get-button Clear | click
get-view "My View" | get-button Add | click
with [get-view "My View"] {
    with [get-table] {
        select "DEFAULT_USER" | activate-cell-edit
        get-editbox | set-text Test
        apply-cell-edit -deactivate
    }
    get-button Set -after [get-label "Experiment Team"] | click
}
get-view Dashboard | get-label Test | get-property "getText()" | equals Test | verify-true
get-view "My View" | get-button Clear | click

/*
*	Users with the same name and different organisations are treated seperately
*	Users with the same name and organisation get amalgamated
*/
with [get-view "My View"] {
    get-button Add | click
    with [get-table] {
        select "DEFAULT_USER" | activate-cell-edit
        with [get-editbox] {
            set-text TEST
            key-type Enter
        }
        apply-cell-edit -deactivate
        select TEST | activate-cell-edit -column 1
        with [get-editbox] {
            set-text "TEST_INST"
            key-type Enter
        }
        apply-cell-edit -deactivate
    }
    get-button Add | click
    with [get-table] {
        select "DEFAULT_USER" | activate-cell-edit
        get-editbox | set-text TEST
        apply-cell-edit -deactivate
    }
    get-button Set -after [get-label "Experiment Team"] | click
}
get-view Dashboard | get-label "TEST and TEST" | get-property "getText()" | equals "TEST and TEST" | verify-true
with [get-view "My View"] {
    with [get-table] {
        select TEST | activate-cell-edit -column 1
        get-editbox | set-text STFC
        apply-cell-edit -deactivate
    }
    get-button Set -after [get-label "Experiment Team"] | click
}
get-view Dashboard | get-label TEST | get-property "getText()" | equals TEST | verify-true
------=_.content-0a7243a0-75d3-3d5f-9791-539de0e5b7ac--
