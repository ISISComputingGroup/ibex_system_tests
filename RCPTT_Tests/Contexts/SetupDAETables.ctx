--- RCPTT testcase ---
Format-Version: 1.0
Context-Type: org.eclipse.rcptt.ctx.ecl
Element-Name: SetupDAETables
Element-Type: context
Element-Version: 2.0
Id: _Paa1cB5jEeaAYI1qYj9bEg
Runtime-Version: 2.0.1.201508250612
Save-Time: 6/6/16 11:21 AM

------=_.ecl.context-718f04b4-ed39-33e3-af62-0995e4561998
Content-Type: text/ecl
Entry-Name: .ecl.context

// Switch to DAE View
get-label "DAE" | click

with [get-view "DAE Control Program"] {

    get-tab-folder | get-tab-item "Experiment Setup" | click
    get-tab-folder -after [get-label "DAE Control Program"] -index 1 | get-tab-item "Data Acquisition" | click
    
    // Set path for tables
    with [get-group Tables] {
        get-combo -after [get-label "Wiring Table:"] | set-text "C:\\Instrument\\Settings\\RCPTT_test_files\\tables\\RCPTT_wiring128.dat"
        get-combo -after [get-label "Detector Table:"] 
            | set-text "C:\\Instrument\\Settings\\RCPTT_test_files\\tables\\RCPTT_detector128.dat"
        get-combo -after [get-label "Spectra Table:"] 
            | set-text "C:\\Instrument\\Settings\\RCPTT_test_files\\tables\\RCPTT_spectra128.dat"
    }
    get-button "Send Changes" | click
    wait 5000

    with [get-tab-folder -after [get-label "DAE Control Program"] -index 1] {
        get-tab-item "Data Acquisition" | click
        get-tab-item "Time Channels" | click
    }
    with [get-group "Time Regimes" | get-table] {
        select "0.0" | activate-cell-edit
        get-editbox | set-text 10
        apply-cell-edit -deactivate
        select "10.0" | activate-cell-edit -column 1
        get-editbox | set-text 1000
        apply-cell-edit -deactivate
        select "10.0" | activate-cell-edit -column 2
        get-editbox | set-text 100
        apply-cell-edit -deactivate
        select "10.0" | activate-cell-edit -column 3
        get-combo | select "dT = C"
    }
    get-button "Send Changes" | click
}

// Wait for changes to be applied
wait 30000
------=_.ecl.context-718f04b4-ed39-33e3-af62-0995e4561998--
